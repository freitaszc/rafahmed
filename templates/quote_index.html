<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Cotações - RafahMed</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/web.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background-color: #f9f9f9;
    }

    h2 {
      font-size: 36px;
      font-weight: 700;
      text-align: center;
      color: #2c3e50;
      margin-bottom: 40px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: relative;
    }

    .top-menu {
      background-color: white;
      padding: 10px 0;
      display: flex;
      justify-content: center;
      gap: 20px;
      border-bottom: 1px solid #eee;
    }

    .top-menu a {
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      font-size: 14px;
      color: #000000;
      text-decoration: none;
      padding: 8px 12px;
      border-radius: 6px;
      transition: 0.3s;
    }

    .top-menu a:hover {
      background-color: #dd1b35;
      color: white;
    }

    .content {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }

    .logo-img {
      width: 100px;
      display: block;
      margin: 0 auto 20px auto;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    .header h2 {
      font-size: 26px;
      color: #2c3e50;
      margin: 0;
    }

    .menu-button {
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      font-weight: 500;
      color: #000000;
      border: 2px solid #dd1b35;
      background-color: white;
      padding: 10px 16px;
      border-radius: 6px;
      text-decoration: none;
      transition: 0.3s ease;
      cursor: pointer;
    }

    .menu-button:hover {
      background-color: #dd1b35;
      color: white;
    }

    .catalog-table {
      width: 100%;
      max-width: 900px;
      margin: 20px auto 0 auto;
      border-collapse: collapse;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      margin-top: 20px;
    }

    .catalog-table th,
    .catalog-table td {
      padding: 12px 14px;
      border-bottom: 1px solid #ddd;
      text-align: center;
    }

    .catalog-table th {
      background-color: #f5f5f5;
      font-weight: 600;
      color: #2c3e50;
    }

    .catalog-table tr:hover {
      background-color: #f4fcfd;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="top-menu">
    <div style="position: absolute; left: 20px;">
        <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="Logo" style="height: 40px;">
    </div>
    <a href="{{ url_for('index') }}">Início</a>
    <a href="{{ url_for('upload') }}">Ponza Lab</a>
    <a href="{{ url_for('quiz_results') }}">Autoavaliações</a>
    <a href="{{ url_for('quote_index') }}">Cotações</a>
    <a href="{{ url_for('catalog') }}">Pacientes</a>
    <a href="{{ url_for('products') }}">Estoque</a>
    <a href="{{ url_for('agenda') }}">Agenda</a>
    <a href="{{ url_for('logout') }}">Sair</a>
  </div>

  <div class="content">
      <h2>Cotações Criadas</h2>
      <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
        <a href="{{ url_for('create_quote') }}" class="menu-button">Nova Cotação</a>
        <a href="{{ url_for('suppliers') }}" class="menu-button">Gerenciar Fornecedores</a>
      </div>
    </div>
  </div>

  {% if quotes %}
  <table class="catalog-table">
    <thead>
      <tr>
        <th>Nome</th>
        <th>Criada em</th>
        <th>Fornecedores</th>
        <th>Respostas</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for quote in quotes %}
      <tr>
        <td onclick="window.location='{{ url_for('quote_results', quote_id=quote.id) }}'">{{ quote.title }}</td>
        <td onclick="window.location='{{ url_for('quote_results', quote_id=quote.id) }}'">{{ quote.created_at }}</td>
        <td onclick="window.location='{{ url_for('quote_results', quote_id=quote.id) }}'">{{ quote.suppliers | length }}
        </td>
        <td onclick="window.location='{{ url_for('quote_results', quote_id=quote.id) }}'">{{ quote.responses | length }}
        </td>
        <td>
          <form method="post" action="{{ url_for('delete_quote', quote_id=quote.id) }}"
            onsubmit="return confirm('Deseja realmente excluir esta cotação?')" style="display:inline;">
            <button type="submit" style="background:none; border:none; font-size:18px; color:#999; cursor:pointer;"
              title="Excluir">×</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% else %}
  <p style="text-align:center; color:#888;">Nenhuma cotação encontrada.</p>
  {% endif %}
  </div>
  <!-- MODAL DE ADICIONAR FORNECEDOR -->
  <div id="addSupplierModal"
    style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:1000;">
    <div style="background:white; padding:20px; border-radius:10px; width:90%; max-width:320px; position:relative;">

      <button onclick="closeSupplierModal()" style="
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 22px;
    font-weight: bold;
    color: #000000;
    cursor: pointer;
    transition: color 0.3s ease;
  " onmouseover="this.style.color='#dd1b35';" onmouseout="this.style.color='#000000';">
        ×
      </button>

      <h2 style="text-align:center; margin-top: 10px;">Cadastrar Fornecedor</h2>
      <form method="post" action="{{ url_for('add_supplier') }}">
        <input type="text" name="name" placeholder="Nome do Fornecedor" required
          style="width:93%; padding:10px; border:1px solid #ccc; border-radius:6px; margin-bottom:10px; font-size: 14px; font-family: 'Montserrat', sans-serif;">
        <input type="email" name="email" placeholder="E-mail" required
          style="width:93%; padding:10px; border:1px solid #ccc; border-radius:6px; margin-bottom:10px; font-size: 14px; font-family: 'Montserrat', sans-serif;">
        <input type="text" name="phone" placeholder="Telefone" required
          style="width:93%; padding:10px; border:1px solid #ccc; border-radius:6px; margin-bottom:10px; font-size: 14px; font-family: 'Montserrat', sans-serif;">
        <div style="display:flex; justify-content:center;">
          <button type="submit" class="menu-button" style="width: 100%;">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script>
    function openSupplierModal() {
      const modal = document.getElementById('addSupplierModal');
      if (modal) modal.style.display = 'flex';
    }

    function closeSupplierModal() {
      const modal = document.getElementById('addSupplierModal');
      if (modal) modal.style.display = 'none';
    }

    // Fecha o modal ao clicar fora dele
    window.addEventListener('click', function (e) {
      const modal = document.getElementById('addSupplierModal');
      if (modal && e.target === modal) {
        closeSupplierModal();
      }
    });
  </script>
</body>

</html>